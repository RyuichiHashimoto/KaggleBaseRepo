# 1スライド目
こちらが目次になります。
初めに、本発表の背景を説明します。

# 2スライド目
近年、自動車に対するサイバー攻撃事例が報告されています。
例えば、こちらにあるように、2015年には、ミラー氏らによって遠隔からハンドルやブレーキを不正制御する攻撃が可能であることが実証されています。

# 3スライド目
このような攻撃事例に対応するため、近年、自動車に対するサイバー攻撃を検知する手法が広く研究されています。この手法で攻撃を検知して分析することで、インシデント対応を効率化します。

# 4スライド目
サイバー攻撃による被害を軽減するためには、事後に対応するだけではなく事前に対策を行っていきたいと考えています。

しかし、従来の攻撃検知手法は、サイバー攻撃の発生を検知する手法です。
サイバー攻撃発生後のインシデント対応しかできず、事前に対策を行うことが難しいです。

# 5スライド目
なので本研究では、
従来の攻撃検知手法ではサイバー攻撃に対する事前対策が難しいという問題点を挙げて、
その解決策として、
サイバー攻撃の発生を予測するため、サイバー攻撃の予兆を検知する手法を提案します。
攻撃発生を予測して事前に対策をすることでサイバー攻撃による被害を軽減していきたいと考えています。

# 6スライド目
先ほど、「サイバー攻撃の予兆を検知する手法」を提案するといいました。
そこで次にはそもそも、「サイバー攻撃の予兆とはなんぞや」について説明していきます。

# 7スライド目
初めに、本研究におけるサイバー攻撃の予兆の定義を説明します。
そもそも、攻撃者が攻撃を行い目的を達成するまでのプロセスは大きく
「偵察活動」、「武器化」、「配送」、「攻撃」、「インストール」、「遠隔制御」、「目的実行」
の７種類あります。
**これらのプロセスは大きく、「事前準備」と「サイバー攻撃の実行」に分類されます。**
この事前準備、すなわち偵察活動、武器化、配送で生じた痕跡を予兆と定義します。
もし、子の予兆を検知することができれば、サイバー攻撃の発生を予測することができ、
サイバー攻撃に対して事前に対策を講じることができると考えられます。

# 8スライド目
本発表では、偵察活動、武器化、配送のうち、偵察活動で生じた痕跡を検知対象とします。
具体的には、マルウェアが感染目的でスキャンする感染活動を検知対象とする。

# 9スライド目
それでは、何が予兆なのか、その予兆をどのように検知するのかについて、具体例を用いながら説明します。
例えば、複数のWebサイトに対してDDoS攻撃を行ったMOOBOTと呼ばれるマルウェアは、初めに感染活動を行ってから、Webサイトに対してDDos攻撃を行っていた。
この感染活動を検知することができれば、後段のDDOS攻撃に対応できると考えられる。

# 10スライド目
それではこの感染活動を検知するために参照するデータを確認しましょう。
初めに、真ん中のグラフを見てください。こちら、横軸は時間、縦軸はマルウェアに感染した疑いのあるホストの台数です。
赤い縦線はMooBotによる攻撃が発生した日です。
こちらを見てもらうと、攻撃発生前にマルウェア感染疑いのホスト数が急激に増加しているのがわかります。
この急激な増加を検知することができれば、のちに来るサイバー攻撃に対して事前に対策できると考えられます。

# 11スライド目
続いて、先ほどの急激な変化を検知するために使用する密度比推定アルゴリズムについて説明します。

# 12スライド目
密度比推定アルゴリズムは、その名の通り、密度比を推定するアルゴリズムなので、
まず初めに密度比について説明します。

密度比とは確率密度の比であり、確率密度関数が既知であれば、既知可能である。
確率密度間の距離が異なるほど、密度比から１から離れる特徴を持ちます。いわゆる距離のような特徴ですね。

例えば、左側のように二つの分布が大きく異なっている場合、密度比は10の10乗の値を持ちます。
一方、右側のように二つの確率分布が重なり合っていて、すごく類似している場合では、密度比は1.001と1に近い値をもちます。

密度比推定アルゴリズムでは、この性質を用いて急激な変化をとらえてきます。

# 13スライド目
密度比は確率密度関数が未知の場合求めることができません。
そこで、密度比を推定するため、本研究ではこの密度比推定アルゴリズムを使用します。

密度比推定アルゴリズムの理論を軽く説明します。  
先ほどの密度比の公式に対してベイズの定理を適用し式変形すると、最終的に右のような式に近似されます。  
ここで、DとDアスタリスクは、未知の確率密度関数から生成されたデータ集合のことして、  
yはあるデータがどちらのデータ集合に属するかを示しています。  
P(y=+1|x)は、あるデータが取得されたときにそれがデータ集合Dに属する確率  
P(y=-11|x)は、それがデータ集合D*に属する確率になります。  
これらは標本xをDとD*に分類する２クラス分類器により推定できます。
ここから、最終的に密度比を推定します。

# 14スライド目
理論としてはこうなのですが、おそらく直観ではないのでイメージがつきづらいと思います。
そのイメージを示したのがこちらのスライドです。

密度比推定アルゴリズムの性質として、
要は２クラス分布利器で分類が容易であれば、二つのデータ集合が大きく異なる。
２クラス分布利器で分類が難しいのであれば、二つのデータ集合が大きく異なる。


例えば、左側のデータ集合をDとD*に分類する分類器を作成する場合、
黒棒で示した単純にx=5より小さければD、大きければDアスタリスクとすれば、簡単に分類可能です。
それほど、二つのデータ集合が分離できるといえます。
逆に、右側の図に対してはxのみの情報では、DとD*を分離することは難しいと思います。
それほど、密度比は類似しているかと思います。

こちらの手法を使って、二つの分布間の違い、距離みたいなものを算出します。
この距離を使って、予兆検知手法を行います。

# 15スライド目
具体的な予兆検知手法を説明します。
まず初めに、今までに観測されたデータを二つのデータ集合に分割します。
分割の仕方は定数です。例えば、現在から１週間前、と１週間前から３か月前という感じですね。
それらの分割したデータセットに対して、密度比推定アルゴリズムを適用し、密度比を推定します。

そして、推定した密度比が閾値を超えた場合、感染活動が行われたと判断します。

例えば、左側の図のようにデータ集合を現在と過去の二つに分類します。

それらのヒストグラムが右側ですが、それに対して、密度比推定アルゴリズムを適用しｔ、密度比を推定します。
それが閾値を超えていた場合、それほどデータが離れている→　急激に変化していると判断して、
感染活動が行われたと判断します。

# 16スライド目
続いて、子の予兆検知手法の性能を評価するための実験を説明します。

# 17スライド目
実験の目的は、先ほど説明した予兆検知手法の検知性能を評価することです。
データセットとして、NICTさんが公開しているダークネットトラフィックデータを使用します。
評価方法として、先行研究でまとめられているマルウェアの感染観測日を用いて、予兆検知手法の検知性能を評価します。
具体的な評価方法については次に説明します。

# 18スライド目
感染観測日の２か月前から１日ずつ予兆検知手法を適用し、検知した日を予兆検知日とします。
子の予兆検知日と、感染活動日の差を見て、提案手法の予兆検知性能を評価します。

# 19スライド目
マルウェアは、感染したから攻撃を実行するまでに潜伏期間をとることが多いです。
既にマルウェアに感染されていても、潜伏期間中であれば、多少の被害は発生するかもしれないが攻撃が発生する前に対応することができます。
そこで、本実験では、潜伏期間中に予兆検知できれば、それも成功だとした。

なお、ソフォスが公開している資料によると、全攻撃の潜伏期間の中央値は10日であり、ランサムウェアによる攻撃の潜伏期間の中央値は９日です。そこで、本実験では、潜伏期間を９日と設定した。

# 20スライド目
本研究では、潜伏期間を先ほどの調査資料で示された期間の中で最短の９日に設定しています。

# 21スライド目
こちらが実験結果のスライドです。
12種類のマルウェアの感染活動に対して予兆検知可能か評価しましたが、
９主のマルウェアに対して、予兆検知に成功し、そのうち５つは感染活動日前に検知していた。
このことから、提案手法は、マルウェアに起因する攻撃の予兆検知に有用だと考えられる。

# 22スライド目
最後にまとめです。

# 24スライド目
こちらがまとめです。


